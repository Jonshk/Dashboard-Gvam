<td>
  <div class="checkbox-checked">
    <input
      (change)="toggleSelected($event)"
      type="checkbox"
      class="form-check-input"
      name="selected"
      id="selected"
      [checked]="device().selected"
    />
  </div>
</td>
<td>
  <a
    class="fw-bold text-underline"
    [routerLink]="['/groups', device().groupId, 'devices', device().deviceId]"
    >{{ device().deviceName }}</a
  >
</td>

@if (device().enrolled) {
  <td>{{ device().imei ?? "-" }}</td>
}

<td>{{ deviceUser()?.email ?? "-" }}</td>

@if (!groupId()) {
  <td>{{ getGroupName(device().groupId) }}</td>
}

<td>
  <div
    class="d-flex flex-column gap-2 flex-wrap justify-content-center align-items-center"
  >
    @if (device().enrolled) {
      <button
        class="btn btn-light btn-sm"
        [disabled]="loadingService.isLoading()"
        (click)="configDevice()"
      >
        Configurar
      </button>
    }
    <button
      class="btn btn-light btn-sm"
      [disabled]="loadingService.isLoading()"
      (click)="editDevice()"
    >
      Editar
    </button>
    <button
      class="btn btn-danger btn-sm"
      [disabled]="loadingService.isLoading()"
      (click)="deleteDevice()"
    >
      Eliminar
    </button>
  </div>
</td>

@if (device().enrolled) {
  <td>
    <form [formGroup]="applyPolicyForm" (ngSubmit)="applyPolicy()">
      <select class="form-select" name="name" formControlName="name">
        @for (policy of groupPolicies(); track policy.name) {
          <option [value]="policy.name">
            {{ policy.name }}
          </option>
        }
      </select>
      <button
        class="btn btn-warning btn-sm"
        type="submit"
        [disabled]="loadingService.isLoading()"
      >
        Aplicar pol√≠tica
      </button>
    </form>
  </td>
  <td>
    <form [formGroup]="sendCommandForm" (ngSubmit)="sendCommand()">
      <select class="form-select" name="command" formControlName="command">
        @for (deviceCommand of deviceCommandKeys; track deviceCommand) {
          <option [value]="DeviceCommand[deviceCommand]">
            {{ DeviceCommandDescription[deviceCommand] }}
          </option>
        }
      </select>
      <button
        class="btn btn-warning btn-sm"
        type="submit"
        [disabled]="loadingService.isLoading()"
      >
        Enviar comando
      </button>
    </form>
  </td>
  <td>
    <form [formGroup]="migrateForm" (ngSubmit)="migrate()">
      <select class="form-select" name="groupId" formControlName="groupId">
        @for (group of groups(); track group.groupId) {
          <option [value]="group.groupId">
            {{ group.groupName }}
          </option>
        }
      </select>
      <button
        class="btn btn-warning btn-sm"
        type="submit"
        [disabled]="loadingService.isLoading()"
      >
        Migrar dispositivo
      </button>
    </form>
  </td>

  <td>
    <button
      class="btn btn-primary"
      [disabled]="!device().remoteControlActive"
      (click)="connect()"
    >
      Conectar
    </button>
  </td>
}
